<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Running a Multistate HiSSE model • hisse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Running a Multistate HiSSE model">
<meta property="og:description" content="hisse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hisse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Clade-specific-sampling.html">The Problem with Clade-specific Sampling Fractions</a>
    </li>
    <li>
      <a href="../articles/GeoHiSSE-vignette.html">Running GeoHiSSE</a>
    </li>
    <li>
      <a href="../articles/MiSSE-vignette.html">Running MiSSE</a>
    </li>
    <li>
      <a href="../articles/MuHiSSE-vignette.html">Running a Multistate HiSSE model</a>
    </li>
    <li>
      <a href="../articles/adding_fossils.html">Incorporating Fossils in HiSSE, MuHiSSE, and MiSSE</a>
    </li>
    <li>
      <a href="../articles/hisse-fisse-type1-vignette.html">Type I errors, Model rejection, &amp; HiSSE vs. FiSSE</a>
    </li>
    <li>
      <a href="../articles/hisse-new-vignette.html">A newer, faster HiSSE function</a>
    </li>
    <li>
      <a href="../articles/hisse-vignette.html">Running the old HiSSE function</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Running a Multistate HiSSE model</h1>
                        <h4 data-toc-skip class="author">Jeremy M.
Beaulieu</h4>
            
      
      
      <div class="hidden name"><code>MuHiSSE-vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>This tutorial gives some basic information on how to set up and
execute parameter estimates when using MuHiSSE (Nakov et al., 2018).</p>
<p>In Nakov et al. (2018), we extended the HiSSE and CID model framework
to handle a four-state case, representing correlated evolution between
two binary characters. Note that a mulitstate version of HiSSE is
available in RevBayes (based on its manual and conversations with
Sebastian Höhna), in <code>SecSSE</code> (Herrera-Alsina et al., 2018),
and as part of the model set described in Caetano et al. (2018). Our
character state combinations were comprised of marine and planktonic
(MP, or state combination <span class="math inline">\(00\)</span>),
marine and benthic (MB, or <span class="math inline">\(01\)</span>),
freshwater and planktonic (FP, or <span class="math inline">\(10\)</span>), and freshwater and benthic (FB, or
<span class="math inline">\(11\)</span>). As with <code>hisse</code>,
rather than optimizing <span class="math inline">\(\lambda_i\)</span>
and <span class="math inline">\(\mu_i\)</span> separately,
<code>MuHiSSE</code> optimizes transformations of these variables.
Again, we let <span class="math inline">\(\tau_i =
\lambda_i+\mu_i\)</span> define “net turnover”, and we let <span class="math inline">\(\epsilon_i = \mu_i / \lambda_i\)</span> define the
“extinction fraction”. This reparameterization alleviates problems
associated with over-fitting when <span class="math inline">\(\lambda_i\)</span> and <span class="math inline">\(\mu_i\)</span> are highly correlated, but both
matter in explaining the diversity pattern (see discussion of this issue
in Beaulieu and O’Meara 2016). The number of free parameters in the
model for both net turnover and extinction fraction are specified as
index vectors provided to the function call. Each vector contains four
entries that correspond to rates associated with the observed states (0
or 1) and the hidden states (A or B). They are always ordered as follows
for a given hidden state, <span class="math inline">\(i\)</span>: <span class="math inline">\(00_i\)</span>, <span class="math inline">\(01_i\)</span>, <span class="math inline">\(10_i\)</span>, <span class="math inline">\(11_i\)</span>.</p>
<p>The set of models included range from (1) the “trivial null” model
that assume no variation in diversification, to (2) a multistate
speciation and extinction model (MuSSE; FitzJohn 2012) that linked
diversification rates to the four character states, but assumed no
variation within regimes, to (3) multistate-dependent speciation and
extinction models with hidden traits (MuHiSSE) and (4) a set of
multistate character-independent models (MuCID) with increasing numbers
of hidden traits (MuCID2 through MuCID8). The most complex MuCID8 model
has, at it’s most complex, eight parameters for turnover and eight
parameters for extinction fraction, matching the complexity of the
MuHiSSE model, but with diversification parameters unlinked to the
observed character states. For any model, we allow the transition rates
between alternative state combinations to differ (e.g., <span class="math inline">\(q_{MB\rightarrow MP} \ne q_{MP\rightarrow
MB}\)</span>), or constrained to be equal (e.g., <span class="math inline">\(q_{MB\rightarrow MP} = q_{MP\rightarrow
MB}\)</span>). In the analyses presented in Nakov et al. (2018), we
disallowed dual transitions (e.g., <span class="math inline">\(q_{MB\rightarrow FP} = 0\)</span>), though this
need not always be the case.</p>
<p>Below I will demonstrate how to set up various models, and how the
likelihoods compare against those from <code>diversitree</code> whenever
possible. In the end, I will also show how a three-state model can be
set up from MuHiSSE and compare the likelihoods against the three-state
MuSSE implemented in GeoHiSSE. However, before getting started, be sure
to load the <code>hisse</code> and <code>diversitree</code>
packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">hisse</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: ape</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: deSolve</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: GenSA</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: subplex</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: nloptr</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.zoology.ubc.ca/prog/diversitree/" class="external-link">diversitree</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulating-a-practice-data-set">Simulating a practice data set<a class="anchor" aria-label="anchor" href="#simulating-a-practice-data-set"></a>
</h2>
<p>Here I will simulate a simple four-state model using
<code>diversitree</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>,  <span class="fl">.15</span>,  <span class="fl">.2</span>, <span class="fl">.1</span>, <span class="co"># lambda 1, 2, 3, 4</span></span>
<span><span class="fl">.03</span>, <span class="fl">.045</span>, <span class="fl">.06</span>, <span class="fl">0.03</span>, <span class="co"># mu 1, 2, 3, 4</span></span>
<span><span class="fl">.05</span>, <span class="fl">.05</span>, <span class="fl">.00</span>,        <span class="co"># q12, q13, q14</span></span>
<span><span class="fl">.05</span>, <span class="fl">.00</span>, <span class="fl">.05</span>,     <span class="co"># q21, q23, q24</span></span>
<span><span class="fl">.05</span>, <span class="fl">.00</span>, <span class="fl">.05</span>,     <span class="co"># q31, q32, q34</span></span>
<span><span class="fl">.00</span>, <span class="fl">.05</span>, <span class="fl">.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/simulate.html" class="external-link">tree.musse</a></span><span class="op">(</span><span class="va">pars</span>, <span class="fl">30</span>, x0<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">states</span> <span class="op">&lt;-</span> <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span></span></code></pre></div>
<p>Now let’s get the likelihood using the same parameters we used to
simulate the data:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lik</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/make.musse.html" class="external-link">make.musse</a></span><span class="op">(</span><span class="va">phy</span>, <span class="va">states</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#lik &lt;- make.musse(phy, states, 3)</span></span>
<span><span class="va">diversitree.free</span> <span class="op">=</span> <span class="fu">lik</span><span class="op">(</span><span class="va">pars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">diversitree.free</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -102.4265</span></span></code></pre>
<p>Now we can use machinery inside MuHiSSE to demonstrate that we
generate the same likelihood. Unfortunately, it takes a little bit of
code to get everything into the right format to run properly. This is
what is shown below. Note, too, that I am transforming <span class="math inline">\(\lambda_i\)</span> and <span class="math inline">\(\mu_i\)</span> into turnover and extinction
fraction:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span>, <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span>, </span>
<span>                     row.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">states</span> <span class="op">&lt;-</span> <span class="va">states</span><span class="op">[</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.label</span>,<span class="op">]</span></span>
<span><span class="va">states.trans</span> <span class="op">&lt;-</span> <span class="va">states</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">states</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">states</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">states</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">states</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">pars.hisse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="va">pars</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="va">pars</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">+</span><span class="va">pars</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>, </span>
<span>                <span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">/</span><span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">/</span><span class="va">pars</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">/</span><span class="va">pars</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span><span class="op">/</span><span class="va">pars</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, </span>
<span>                <span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0</span>, <span class="fl">0.05</span>,<span class="fl">0</span>,<span class="fl">0.05</span>, <span class="fl">0.05</span>,<span class="fl">0</span>,<span class="fl">.05</span>, <span class="fl">0</span>,<span class="fl">0.05</span>,<span class="fl">.05</span><span class="op">)</span></span>
<span><span class="va">model.vec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">384</span><span class="op">)</span></span>
<span><span class="va">model.vec</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">=</span> <span class="va">pars.hisse</span></span>
<span><span class="va">phy</span><span class="op">$</span><span class="va">node.label</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">cache</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">ParametersToPassMuHiSSE</span><span class="op">(</span>model.vec<span class="op">=</span><span class="va">model.vec</span>, hidden.states<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>                                         nb.tip<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span>, nb.node<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Nnode</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span>, </span>
<span>                                         bad.likelihood<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">300</span><span class="op">)</span>, f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, ode.eps<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">cache</span><span class="op">$</span><span class="va">psi</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">FindGenerations</span><span class="op">(</span><span class="va">phy</span><span class="op">)</span></span>
<span><span class="va">dat.tab</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">OrganizeData</span><span class="op">(</span><span class="va">states.trans</span>, <span class="va">phy</span>, f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, hidden.states<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">hisse.constrained</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">DownPassMuHisse</span><span class="op">(</span><span class="va">dat.tab</span>, gen<span class="op">=</span><span class="va">gen</span>, cache<span class="op">=</span><span class="va">cache</span>, </span>
<span>                                             root.type<span class="op">=</span><span class="st">"madfitz"</span>, condition.on.survival<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                             root.p<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">hisse.constrained</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diversitree.free</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>The implementation is correct. However, in the above case, we did not
actually use any hidden states. We can also show that the likelihoods
are identical to MuSSE so as long as the dynamics are the same among all
included hidden states. Here we will just use hidden states A and B:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pars.hisse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="va">pars</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="va">pars</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">+</span><span class="va">pars</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>, </span>
<span>                <span class="va">pars</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">/</span><span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">/</span><span class="va">pars</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">/</span><span class="va">pars</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">pars</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span><span class="op">/</span><span class="va">pars</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, </span>
<span>                <span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0</span>, <span class="fl">0.05</span>,<span class="fl">0</span>,<span class="fl">0.05</span>, <span class="fl">0.05</span>,<span class="fl">0</span>,<span class="fl">.05</span>, <span class="fl">0</span>,<span class="fl">0.05</span>,<span class="fl">.05</span>, <span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fl">1</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">model.vec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">384</span><span class="op">)</span></span>
<span><span class="va">model.vec</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">96</span><span class="op">]</span> <span class="op">=</span> <span class="va">pars.hisse</span></span>
<span><span class="va">phy</span><span class="op">$</span><span class="va">node.label</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">cache</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">ParametersToPassMuHiSSE</span><span class="op">(</span>model.vec<span class="op">=</span><span class="va">model.vec</span>, hidden.states<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>                                         nb.tip<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span>, nb.node<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Nnode</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span>, </span>
<span>                                         bad.likelihood<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">300</span><span class="op">)</span>, f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                         ode.eps<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">cache</span><span class="op">$</span><span class="va">psi</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">FindGenerations</span><span class="op">(</span><span class="va">phy</span><span class="op">)</span></span>
<span><span class="va">dat.tab</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">OrganizeData</span><span class="op">(</span><span class="va">states.trans</span>, <span class="va">phy</span>, f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, hidden.states<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">hisse.constrained</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">DownPassMuHisse</span><span class="op">(</span><span class="va">dat.tab</span>, gen<span class="op">=</span><span class="va">gen</span>, cache<span class="op">=</span><span class="va">cache</span>, </span>
<span>                                             root.type<span class="op">=</span><span class="st">"madfitz"</span>, condition.on.survival<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                             root.p<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">hisse.constrained</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diversitree.free</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Again, the likelihoods are identical and the implementation is
correct. Note that the likelihood can also be calculated using the root
likelihood summary procedure described by Herrera-Alsina et al. (2018).
This is specified by doing <code>root.type="herr_als"</code>. Note,
however, that in our testing the likelihood differences are subtle, and
in simulation the parameter estimates are nearly indistinguishable from
the original root summary implementation of FitzJohn et al. (2009).</p>
</div>
<div class="section level2">
<h2 id="setting-up-a-musse-model-using-muhisse">Setting up a MuSSE model using MuHiSSE<a class="anchor" aria-label="anchor" href="#setting-up-a-musse-model-using-muhisse"></a>
</h2>
<p>As mentioned above, the number of free parameters in the model for
both net turnover and extinction fraction are specified as index vectors
provided to the function call. Each vector contains four entries that
correspond to rates associated with the observed states (0 or 1) and the
hidden states (A or B). They are always ordered as follows for a given
hidden state, <span class="math inline">\(i\)</span>: <span class="math inline">\(00_i\)</span>, <span class="math inline">\(01_i\)</span>, <span class="math inline">\(10_i\)</span>, <span class="math inline">\(11_i\)</span>. However, in this case we do not
want any hidden states. But first let’s set up the “dull null” – i.e.,
turnover and extinction fraction are the same for all observed state
combinations. Note the “f” represents the sampling fraction for each
observed state combination, which is a vector ordered in the same manner
as for turnover and extinction fraction vectors:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Next, we have to set up a transition matrix. There is a function
provided to make this easy, and allows users to customize the matrix to
fit particular hypotheses. Be sure to look at the options on this
function call, for allowing diagonals and for customizing the matrix
when you have character independent model.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trans.rate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      (00) (01) (10) (11)</span></span>
<span><span class="co">## (00)   NA    3    5    0</span></span>
<span><span class="co">## (01)    1   NA    0    7</span></span>
<span><span class="co">## (10)    2    0   NA    8</span></span>
<span><span class="co">## (11)    0    4    6   NA</span></span></code></pre>
<p>Now, we can call MuHiSSE and estimate the parameters under this model
using the default settings:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">states.trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.label</span>, <span class="va">states.trans</span><span class="op">)</span></span>
<span><span class="va">dull.null</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MuHiSSE.html">MuHiSSE</a></span><span class="op">(</span>phy<span class="op">=</span><span class="va">phy</span>, data<span class="op">=</span><span class="va">states.trans</span>, f<span class="op">=</span><span class="va">f</span>, turnover<span class="op">=</span><span class="va">turnover</span>, </span>
<span>                     eps<span class="op">=</span><span class="va">extinction.fraction</span>, hidden.states<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>                     trans.rate<span class="op">=</span><span class="va">trans.rate</span><span class="op">)</span></span></code></pre></div>
<p>If you wanted to set up a true MuSSE model, where the turnover rate
parameters are unlinked across the observed state combinations, you
would simply do the following:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">MuSSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MuHiSSE.html">MuHiSSE</a></span><span class="op">(</span>phy<span class="op">=</span><span class="va">phy</span>, data<span class="op">=</span><span class="va">states.trans</span>, f<span class="op">=</span><span class="va">f</span>, turnover<span class="op">=</span><span class="va">turnover</span>, </span>
<span>                     eps<span class="op">=</span><span class="va">extinction.fraction</span>, hidden.states<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>                     trans.rate<span class="op">=</span><span class="va">trans.rate</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setting-up-a-character-dependent-muhisse-model">Setting up a character-dependent MuHiSSE model<a class="anchor" aria-label="anchor" href="#setting-up-a-character-dependent-muhisse-model"></a>
</h2>
<p>Setting up a character-dependent MuHiSSE model is relatively
straightforward, and relies on all the same tools as above. One
important thing to bear in mind, is that again, the states are ordered
by state combination within each hidden state. For example, if you want
two hidden states, A and B, the order of the parameters in the model is
00A, 01A, 10A, 11A, 00B, 01B, 10B, and 11B. So, in this case, we just
need to specify the free parameters we want for diversification. Here we
are just going assume turnover varies across the different states:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span> </span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We also have to extend the transition rate matrix. This is done by
specifying the number of hidden states:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trans.rate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       (00A) (01A) (10A) (11A) (00B) (01B) (10B) (11B)</span></span>
<span><span class="co">## (00A)    NA     3     5     0    17    NA    NA    NA</span></span>
<span><span class="co">## (01A)     1    NA     0     7    NA    17    NA    NA</span></span>
<span><span class="co">## (10A)     2     0    NA     8    NA    NA    17    NA</span></span>
<span><span class="co">## (11A)     0     4     6    NA    NA    NA    NA    17</span></span>
<span><span class="co">## (00B)    17    NA    NA    NA    NA    11    13     0</span></span>
<span><span class="co">## (01B)    NA    17    NA    NA     9    NA     0    15</span></span>
<span><span class="co">## (10B)    NA    NA    17    NA    10     0    NA    16</span></span>
<span><span class="co">## (11B)    NA    NA    NA    17     0    12    14    NA</span></span></code></pre>
<p>Now, we can just plug these options into MuHiSSE:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MuHiSSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MuHiSSE.html">MuHiSSE</a></span><span class="op">(</span>phy<span class="op">=</span><span class="va">phy</span>, data<span class="op">=</span><span class="va">states.trans</span>, f<span class="op">=</span><span class="va">f</span>, turnover<span class="op">=</span><span class="va">turnover</span>, </span>
<span>                     eps<span class="op">=</span><span class="va">extinction.fraction</span>, hidden.states<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>                     trans.rate<span class="op">=</span><span class="va">trans.rate</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setting-up-a-character-independent-muhisse-model">Setting up a character-independent MuHiSSE model<a class="anchor" aria-label="anchor" href="#setting-up-a-character-independent-muhisse-model"></a>
</h2>
<p>Remember, for any character-independent model, the diversification
rates <em>must</em> be decoupled from the observed states. So, to do
this, we simply set the diversification rates to be equal for all states
for a given hidden state. Below, I will show how to do this for a
character-independent model with two rate shifts in the tree:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span> </span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>For the transition rate matrix, I included a setting called
<code>make.null</code> that simply replicates the transition model
across the hidden states. This way the transition rates are not impacted
by changes in the diversification rate regime – that is, <span class="math inline">\(q_{MB,A\rightarrow MP,A} = q_{MB,B\rightarrow
MP,B}\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">1</span>, make.null<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trans.rate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       (00A) (01A) (10A) (11A) (00B) (01B) (10B) (11B)</span></span>
<span><span class="co">## (00A)    NA     3     5     0     9    NA    NA    NA</span></span>
<span><span class="co">## (01A)     1    NA     0     7    NA     9    NA    NA</span></span>
<span><span class="co">## (10A)     2     0    NA     8    NA    NA     9    NA</span></span>
<span><span class="co">## (11A)     0     4     6    NA    NA    NA    NA     9</span></span>
<span><span class="co">## (00B)     9    NA    NA    NA    NA     3     5     0</span></span>
<span><span class="co">## (01B)    NA     9    NA    NA     1    NA     0     7</span></span>
<span><span class="co">## (10B)    NA    NA     9    NA     2     0    NA     8</span></span>
<span><span class="co">## (11B)    NA    NA    NA     9     0     4     6    NA</span></span></code></pre>
<p>Here is a how you would set up the diversification rates for models
with three hidden state all the way to eight hidden states:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Three hidden states</span></span>
<span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span> </span>
<span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">2</span>, make.null<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Four hidden states</span></span>
<span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span> </span>
<span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">3</span>, make.null<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Five hidden states</span></span>
<span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span> </span>
<span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">4</span>, make.null<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Six hidden states</span></span>
<span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">24</span><span class="op">)</span> </span>
<span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">5</span>, make.null<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Seven hidden states</span></span>
<span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">28</span><span class="op">)</span> </span>
<span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">6</span>, make.null<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Eight hidden states</span></span>
<span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">32</span><span class="op">)</span> </span>
<span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">7</span>, make.null<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="relationship-of-muhisse-to-a-three-state-geosse-without-cladogenetic-changes">Relationship of MuHiSSE to a three-state GeoSSE without cladogenetic
changes<a class="anchor" aria-label="anchor" href="#relationship-of-muhisse-to-a-three-state-geosse-without-cladogenetic-changes"></a>
</h2>
<p>As of June 2017, I have implemented a three-state MuSSE model as part
of the model set for GeoHiSSE (see Caetano et al., 2018). If
cladogenetic changes are disallowed, then the geographic model
essentially reverts back to three-state MuSSE model. Below I will show
how the likelihoods are equivalent between <code>diversitree</code>,
<code>GeoHiSSE</code>, and <code>MuHiSSE</code> in the three-state
case.</p>
<p>First, let’s simulate a three-state model:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>,  <span class="fl">.15</span>,  <span class="fl">.2</span>,  <span class="co"># lambda 1, 2, 3</span></span>
<span><span class="fl">.03</span>, <span class="fl">.045</span>, <span class="fl">.06</span>, <span class="co"># mu 1, 2, 3</span></span>
<span><span class="fl">.05</span>, <span class="fl">0</span>,         <span class="co"># q12, q13</span></span>
<span><span class="fl">.05</span>, <span class="fl">.05</span>,       <span class="co"># q21, q23</span></span>
<span><span class="fl">0</span>,   <span class="fl">.05</span><span class="op">)</span>       <span class="co"># q31, q32</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/simulate.html" class="external-link">tree.musse</a></span><span class="op">(</span><span class="va">pars</span>, <span class="fl">30</span>, x0<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">states</span> <span class="op">&lt;-</span> <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span></span>
<span><span class="va">lik</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/make.musse.html" class="external-link">make.musse</a></span><span class="op">(</span><span class="va">phy</span>, <span class="va">states</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">lik.base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/constrain.html" class="external-link">constrain</a></span><span class="op">(</span><span class="va">lik</span>, <span class="va">lambda2</span> <span class="op">~</span> <span class="va">lambda1</span>, <span class="va">lambda3</span> <span class="op">~</span> <span class="va">lambda1</span>,</span>
<span><span class="va">mu2</span> <span class="op">~</span> <span class="va">mu1</span>, <span class="va">mu3</span> <span class="op">~</span> <span class="va">mu1</span>,</span>
<span><span class="va">q13</span> <span class="op">~</span> <span class="fl">0</span>, <span class="va">q21</span> <span class="op">~</span> <span class="va">q12</span>, <span class="va">q23</span> <span class="op">~</span> <span class="va">q12</span>, <span class="va">q31</span> <span class="op">~</span> <span class="fl">0.03</span>, <span class="va">q32</span> <span class="op">~</span> <span class="va">q12</span><span class="op">)</span></span></code></pre></div>
<p>Here is the likelihood for a maximally constrained model using
<code>diversitree</code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diversitree.constrained</span> <span class="op">=</span> <span class="fu">lik.base</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.03</span>, <span class="fl">.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">diversitree.constrained</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -111.1472</span></span></code></pre>
<p>Now, let’s compare the likelihood using a three-state model in
<code>GeoHiSSE</code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span>, <span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span>, row.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.state</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">states</span> <span class="op">&lt;-</span> <span class="va">states</span><span class="op">[</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.label</span>,<span class="op">]</span></span>
<span><span class="va">states</span><span class="op">[</span><span class="va">states</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">==</span><span class="fl">3</span>,<span class="op">]</span> <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="va">pars.hisse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.03</span>, <span class="fl">0.03</span>, <span class="fl">0.03</span>, <span class="fl">0.05</span>, <span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">model.vec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">120</span><span class="op">)</span></span>
<span><span class="va">model.vec</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span> <span class="op">=</span> <span class="va">pars.hisse</span></span>
<span><span class="va">phy</span><span class="op">$</span><span class="va">node.label</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">cache</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">ParametersToPassMuSSE</span><span class="op">(</span><span class="va">phy</span>, <span class="va">states</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">model.vec</span>, f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, hidden.states<span class="op">=</span><span class="st">"TEST1"</span><span class="op">)</span></span>
<span><span class="va">geosse.constrained</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">DownPassMusse</span><span class="op">(</span><span class="va">phy</span>, <span class="va">cache</span>, hidden.states<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>                                            root.type<span class="op">=</span><span class="st">"madfitz"</span>, condition.on.survival<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                            root.p<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">geosse.constrained</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diversitree.constrained</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>We can show that you can obtain the same likelihood using
<code>MuHiSSE</code>. Warning: as before it’s a bit convoluted to format
the data properly, but it can be done:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">states.trans</span> <span class="op">&lt;-</span> <span class="va">states</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">states</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">states</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">states</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="va">states.trans</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">pars.hisse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">+</span><span class="fl">0.03</span>,<span class="fl">0.1</span><span class="op">+</span><span class="fl">0.03</span>,<span class="fl">0.1</span><span class="op">+</span><span class="fl">0.03</span>,<span class="fl">0</span>, </span>
<span>                <span class="fl">0.03</span><span class="op">/</span><span class="fl">0.1</span>,<span class="fl">0.03</span><span class="op">/</span><span class="fl">0.1</span>,<span class="fl">0.03</span><span class="op">/</span><span class="fl">0.1</span>,<span class="fl">0</span>,</span>
<span>                <span class="fl">0.05</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0</span>, <span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">model.vec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">384</span><span class="op">)</span></span>
<span><span class="va">model.vec</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">=</span> <span class="va">pars.hisse</span></span>
<span><span class="va">phy</span><span class="op">$</span><span class="va">node.label</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">cache</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">ParametersToPassMuHiSSE</span><span class="op">(</span>model.vec<span class="op">=</span><span class="va">model.vec</span>, hidden.states<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>                                         nb.tip<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span>, nb.node<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Nnode</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span>, </span>
<span>                                         bad.likelihood<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">300</span><span class="op">)</span>, f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                                         ode.eps<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">cache</span><span class="op">$</span><span class="va">psi</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">FindGenerations</span><span class="op">(</span><span class="va">phy</span><span class="op">)</span></span>
<span><span class="va">dat.tab</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">OrganizeData</span><span class="op">(</span><span class="va">states.trans</span>, <span class="va">phy</span>, f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, hidden.states<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">muhisse.constrained</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">DownPassMuHisse</span><span class="op">(</span><span class="va">dat.tab</span>, gen<span class="op">=</span><span class="va">gen</span>, cache<span class="op">=</span><span class="va">cache</span>, </span>
<span>                                             root.type<span class="op">=</span><span class="st">"madfitz"</span>, condition.on.survival<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                            root.p<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">muhisse.constrained</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diversitree.constrained</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>As you can see, in the absence of hidden states, all three
implementations provide identical likelihoods.</p>
<p>It is also easy to show how you would set up a three-state model
using MuHiSSE. This may be beneficial with rather large trees. With
<code>MuHiSSE</code>, as well as <code>fGeoHiSSE</code>, I’ve
implemented a much more efficient and rather fast tree traversal
algorithm. Eventually, both functions will allow for multicore
processing during the tree traversal stage.</p>
<p>For this example, note that we are going to assume we do not have a
fourth state (i.e., <span class="math inline">\(11\)</span>).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>Next, we have to generate, and then modify the transition rate
matrix:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trans.rate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      (00) (01) (10) (11)</span></span>
<span><span class="co">## (00)   NA    3    5    0</span></span>
<span><span class="co">## (01)    1   NA    0    7</span></span>
<span><span class="co">## (10)    2    0   NA    8</span></span>
<span><span class="co">## (11)    0    4    6   NA</span></span></code></pre>
<p>We can use the <code><a href="../reference/transMat.html">ParDrop()</a></code> function to remove transitions
to and from the fourth state in the model:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trans.rate.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMat.html">ParDrop</a></span><span class="op">(</span><span class="va">trans.rate</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trans.rate.mod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      (00) (01) (10) (11)</span></span>
<span><span class="co">## (00)   NA    3    4    0</span></span>
<span><span class="co">## (01)    1   NA    0    0</span></span>
<span><span class="co">## (10)    2    0   NA    0</span></span>
<span><span class="co">## (11)    0    0    0   NA</span></span></code></pre>
<p>From there the function call is all the same:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MuHiSSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MuHiSSE.html">MuHiSSE</a></span><span class="op">(</span>phy<span class="op">=</span><span class="va">phy</span>, data<span class="op">=</span><span class="va">states.trans</span>, f<span class="op">=</span><span class="va">f</span>, turnover<span class="op">=</span><span class="va">turnover</span>, </span>
<span>                     eps<span class="op">=</span><span class="va">extinction.fraction</span>, hidden.states<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>                     trans.rate<span class="op">=</span><span class="va">trans.rate.mod</span><span class="op">)</span></span></code></pre></div>
<p>If you wanted to set up a three-state model, but include hidden
states, you would do the following:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span>, <span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">extinction.fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>, <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">trans.rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMatMakerMuHiSSE.html">TransMatMakerMuHiSSE</a></span><span class="op">(</span>hidden.traits<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">trans.rate.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transMat.html">ParDrop</a></span><span class="op">(</span><span class="va">trans.rate</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">12</span>,<span class="fl">14</span>,<span class="fl">15</span>,<span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="other-considerations">Other considerations<a class="anchor" aria-label="anchor" href="#other-considerations"></a>
</h2>
<p>Like with <code>hisse</code> and <code>GeoHiSSE</code>, there are
functions available to obtain model averages (i.e.,
<code><a href="../reference/modelAveRates.html">GetModelAveRates()</a></code>), generate estimates of the uncertainty
in the parameter estimates (i.e., <code><a href="../reference/supportRegionMuHiSSE.html">SupportRegionMuHiSSE()</a></code>),
calculate the marginal probabilities for states at nodes (i.e.,
<code><a href="../reference/marginReconMuHiSSE.html">MarginReconMuHiSSE()</a></code>), plotting the rate variation on the
tree (i.e., <code><a href="../reference/plotMuHiSSE.html">plot.muhisse.states()</a></code>), and model-averaging the
rates based on the equilibrium frequencies (i.e.,
<code>GetModelAveEqFreqs()</code>). Users are encouraged to read other
vignettes and help pages provided for more information. For more
conceptual discussions of these functions and ideas, readers are also
encouraged to read Caetano et al. (2018).</p>
<p>One additional item that is worth mentioning. I would recommend users
try multiple random starting points when optimizing any given model with
<code>MuHiSSE</code>. In Nakov et al. (2018), we found that the default
starting values often did not return the highest log likelihood. To
alleviate this issue, we performed <span class="math inline">\(\ge\)</span> 50 maximum likelihood optimizations
for each model, each initiated from a distinct starting point. All
functions with <code>hisse</code> are provided with
<code>starting.vals</code> option for these purposes. In the case of
Nakov et al. (2018), we wrote our own custom function, which I have
provided below using a MuCID3 model. Note that the following function
was designed for multicore use:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">StartingValueTry</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">phy</span>, <span class="va">data</span>, <span class="va">f</span>, <span class="va">trans.rate</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>    <span class="va">freqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">1</span>, </span>
<span>                         <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span>, collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>, </span>
<span>                                            <span class="st">"00"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"01"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"10"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"11"</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">samp.freq.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip</a></span><span class="op">(</span><span class="va">phy</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">freqs</span> <span class="op">/</span> <span class="va">f</span><span class="op">)</span></span>
<span>    <span class="va">init.pars</span> <span class="op">&lt;-</span> <span class="fu">hisse</span><span class="fu">:::</span><span class="fu">starting.point.generator</span><span class="op">(</span><span class="va">phy</span>, <span class="fl">4</span>, <span class="va">samp.freq.tree</span>, yule<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">turnover</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">eps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">turnover</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">NewStarting</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">iteration</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">turn.start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">init.pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">init.pars</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">eps.start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="va">trans.start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">init.pars</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">starting.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">turn.start</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">eps.start</span>,<span class="fl">4</span><span class="op">)</span>, <span class="va">trans.start</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">starting.vals</span><span class="op">)</span></span>
<span>        <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MuHiSSE.html">MuHiSSE</a></span><span class="op">(</span><span class="va">phy</span>, <span class="va">data</span>, f<span class="op">=</span><span class="va">f</span>, turnover<span class="op">=</span><span class="va">turnover</span>, eps<span class="op">=</span><span class="va">eps</span>, trans.rate<span class="op">=</span><span class="va">trans.rate</span>,</span>
<span>                       hidden.states<span class="op">=</span><span class="cn">TRUE</span>, starting.vals<span class="op">=</span><span class="va">starting.vals</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">tmp</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"startingValsTest"</span>, <span class="va">iteration</span>, <span class="st">".Rsave"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu">mclapply</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="va">NewStarting</span>, mc.cores<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Caetano, D.S., B.C. O’Meara, and J.M. Beaulieu. 2018. Hidden state
models improve state-dependent diversification approaches, including
biogeographic models. Evolution, 72:2308-2324.</p>
<p>FitzJohn R., W.P. Maddison, and S.P. Otto. 2009. Estimating
trait-dependent speciation and extinction rates from incompletely
resolved phylogenies, Systematic Biology, 58: 595-611.</p>
<p>FitzJohn R.G. 2012. Diversitree: comparative phylogenetic analyses of
diversification in R. Methods in Ecology and Evolution 3:1084-1092.</p>
<p>Herrera-Alsina, L., P. van Els, and R.S. Etienne. 2018. Detecting the
dependence of diversification on multiples traits from phylogenetic
trees and trait data. Systematic Biology, 68:317-328.</p>
<p>Nakov, T., Beaulieu, J.M., and Alverson, A.J. 2019. Diatoms diversify
and turn over faster in freshwater than marine environments. Evolution,
doi: <a href="https://doi.org/10.1111/evo.13832" class="external-link uri">https://doi.org/10.1111/evo.13832</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jeremy Beaulieu, Brian O’Meara, Daniel Caetano, James Boyko, Thais Vasconcelos.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
