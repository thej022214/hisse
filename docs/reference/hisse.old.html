<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Original Hidden State Speciation and Extinction — hisse.old • hisse</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Original Hidden State Speciation and Extinction — hisse.old"><meta property="og:description" content="Sets up and executes the original HiSSE model (Hidden State Speciation and Extinction) on a phylogeny and character distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hisse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Clade-specific-sampling.html">The Problem with Clade-specific Sampling Fractions</a>
    </li>
    <li>
      <a href="../articles/GeoHiSSE-vignette.html">Running GeoHiSSE</a>
    </li>
    <li>
      <a href="../articles/MiSSE-vignette.html">Running MiSSE</a>
    </li>
    <li>
      <a href="../articles/MuHiSSE-vignette.html">Running a Multistate HiSSE model</a>
    </li>
    <li>
      <a href="../articles/adding_fossils.html">Incorporating Fossils in HiSSE, MuHiSSE, and MiSSE</a>
    </li>
    <li>
      <a href="../articles/hisse-fisse-type1-vignette.html">Type I errors, Model rejection, &amp; HiSSE vs. FiSSE</a>
    </li>
    <li>
      <a href="../articles/hisse-new-vignette.html">A newer, faster HiSSE function</a>
    </li>
    <li>
      <a href="../articles/hisse-vignette.html">Running the old HiSSE function</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Original Hidden State Speciation and Extinction</h1>
    
    <div class="hidden name"><code>hisse.old.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Sets up and executes the original HiSSE model (Hidden State Speciation and Extinction) on a phylogeny and character distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hisse.old</span><span class="op">(</span><span class="va">phy</span>, <span class="va">data</span>, f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, hidden.states<span class="op">=</span><span class="cn">TRUE</span>, turnover.anc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>eps.anc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, trans.rate<span class="op">=</span><span class="cn">NULL</span>, turnover.beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>eps.beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, timeslice<span class="op">=</span><span class="cn">NULL</span>, condition.on.survival<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>root.type<span class="op">=</span><span class="st">"madfitz"</span>, root.p<span class="op">=</span><span class="cn">NULL</span>, output.type<span class="op">=</span><span class="st">"turnover"</span>, sann<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>sann.its<span class="op">=</span><span class="fl">1000</span>, bounded.search<span class="op">=</span><span class="cn">TRUE</span>, max.tol<span class="op">=</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">.50</span>,</span>
<span>starting.vals<span class="op">=</span><span class="cn">NULL</span>, turnover.upper<span class="op">=</span><span class="fl">10000</span>, eps.upper<span class="op">=</span><span class="fl">3</span>, trans.upper<span class="op">=</span><span class="fl">100</span>,</span>
<span>ode.eps<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>phy</dt>
<dd><p>a phylogenetic tree, in <code>ape</code> “phylo” format and with internal nodes labeled denoting the ancestral selective regimes.</p></dd>

<dt>data</dt>
<dd><p>a data matrix containing species information (see Details).</p></dd>

<dt>f</dt>
<dd><p>vector of length 2 with the estimated proportion of extant species in state 0 and 1 that are included in the phylogeny. A value of c(0.25, 0.5) means that 25 percent of species in state 0 and 50 percent of species in state 1 are included in the phylogeny. By default all species are assumed to be sampled.</p></dd>

<dt>hidden.states</dt>
<dd><p>a logical indicating whether the model includes a hidden state. The default is <code>FALSE</code>.</p></dd>
 
<dt>turnover.anc</dt>
<dd><p>a vector of length 4, indicating the free parameters associated with the net turnover rates. Default settings is a BiSSE model with fixed turnover rates for both observed states (see Details).</p></dd>
 
<dt>eps.anc</dt>
<dd><p>a vector of length 4, indicating the free parameters associated with the extinction fractions. Default settings is a BiSSE model with fixed extinction fractions for both observed states (see Details).</p></dd>
 
<dt>trans.rate</dt>
<dd><p>provides the transition rate model.</p></dd>

<dt>turnover.beta</dt>
<dd><p>a vector of length 4, indicating the free parameters associated with time-varying net turnover rates (see Details).</p></dd>

<dt>eps.beta</dt>
<dd><p>a vector of length 4, indicating the free parameters associated with time-varying extinction fractions (see Details).</p></dd>

<dt>timeslice</dt>
<dd><p>a user-supplied time to split the tree.</p></dd>

<dt>condition.on.survival</dt>
<dd><p>a logical indicating whether the likelihood should be conditioned on the survival of two lineages and the speciation event subtending them (Nee et al. 1994). The default is <code>TRUE</code>.</p></dd>

<dt>root.type</dt>
<dd><p>indicates whether root summarization follow the procedure described by FitzJohn et al. 2009, “madfitz” or Herrera-Alsina et al. 2018, “herr_als”.</p></dd>

<dt>root.p</dt>
<dd><p>a vector indicating fixed root state probabilities. The default is <code>NULL</code>.</p></dd>

<dt>output.type</dt>
<dd><p>indicates whether the rates should be printed onscreen as the optimized variables, “turnover”, transformed to reflect net diversification, “net.div”, or transformed to reflect \(\lambda\) and \(\mu\), “raw”.</p></dd>

<dt>sann</dt>
<dd><p>a logical indicating whether a two-step optimization procedure is to be used. The first includes a simulate annealing approach, with the second involving a refinement using <code>subplex</code>. The default is <code>TRUE</code>.</p></dd>

<dt>sann.its</dt>
<dd><p>a numeric indicating the number of times the simulated annealing algorithm should call the objective function.</p></dd>

<dt>bounded.search</dt>
<dd><p>a logical indicating whether or not bounds should be enforced during optimization. The default is is <code>TRUE</code>.</p></dd>

<dt>max.tol</dt>
<dd><p>supplies the relative optimization tolerance to <code>subplex</code>.</p></dd>

<dt>starting.vals</dt>
<dd><p>a vector of starting values to be used instead of the default settings. These are just three values given in the following order: turnover (1), extinction fraction (2), and a single transition rate (3)</p></dd>

<dt>turnover.upper</dt>
<dd><p>sets the upper bound for the turnover parameters. The default upper bound assumes an event occurs every 100 years.</p></dd>

<dt>eps.upper</dt>
<dd><p>sets the upper bound for the extinction fraction parameters.</p></dd>

<dt>trans.upper</dt>
<dd><p>sets the upper bound for the transition rate parameters.</p></dd>

<dt>ode.eps</dt>
<dd><p>sets the tolerance for the integration at the end of a branch. Essentially if the sum of compD is less than this tolerance, then it assumes the results are unstable and discards them. The default is set to zero, but in testing a value of 1e-8 can sometimes produce stable solutions for both easy and very difficult optimization problems.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function sets up and executes the original HiSSE model. The model closely follows <code>diversitree</code>, although here we employ modified optimization procedures. For example, rather than optimizing birth and death separately, hisse optimizes orthogonal transformations of these variables: we let tau = birth+death define "net turnover", and we let eps = death/birth define the “extinction fraction”. This reparameterization alleviates problems associated with overfitting when birth and death are highly correlated, but both matter in explaining the diversity pattern. As for data file format, <code>hisse</code> expects a two column matrix or data frame, with the first column containing the species names and the second containing the binary character information. Note that the order of the data file and the names in the “phylo” object need not be in the same order; <code>hisse</code> deals with this internally. Also, the character information should be binary and coded as 0 and 1, otherwise the function will misbehave. However, if the state for a species is unknown, a user can specify this with a 2, and the state will be considered maximally ambiguous.</p>
<p>To setup a model, users input vectors containing values to indicate how many free parameters are to be estimated for each of the variables in the model. For example, the “turnover.anc” input vector is set by default as c(1,1,0,0). This means for state 0 and state 1, we are allowing one free parameter to define the net turnover rate (birth+death) in the model. This is essentially a BiSSE model with fixed turnover rates. Now, say we want to include separate turnover rates for both states we would simply input c(1,2,0,0). The last two entries, which in the preceding example are set to zero, correspond to the hidden states; the third entry corresponds to a hidden state associated with observed state 0, such that 0A (hidden state absent) is the first entry, and 0B (hidden state present) is the third entry. So, to set up a model with three turnover rates, where we include a free parameter for a hidden state associated with state 0 we input c(1,2,3,0). A full model would thus be c(1,2,3,4), which corresponds to four separate net turnover rates, for states 0A (first entry), 1A (second entry), 0B (third entry), and 1B (fourth entry). Extinction fraction, or “eps.anc”, follows the same format, though including a zero for a state we want to include in the model corresponds to no extinction, which is the Yule equivalent. In general, we follow this format to make it easier to generate a large set of nested models. Once the model is specified, the parameters can be estimated using the subplex routine (default), or use a two-step process (i.e., sann=TRUE) that first employs a stochastic simulated annealing procedure, which is later refined using the subplex routine.</p>
<p>The “trans.rate” input is the transition model and has an entirely different setup than turnover and extinction rates. See <code>TransMatMaker</code> function for more details.</p>
<p>For user-specified “root.p”, you should specify the probability for each state. If you are doing a hidden model, there will be four states: 0A, 1A, 0B, 1B. So if you wanted to say the root had to be state 0, you would specify “root.p = c(0.5, 0, 0.5, 0)”.</p>
<p>For the “root.type” option, we are currently maintaining the previous default of 
“madfitz”. However, it was recently pointed out by Herrera-Alsina et al. (2018)
that at the root, the individual likelihoods for each possible state should be conditioned
prior to averaging the individual likelihoods across states. This can be set doing 
“herr_als”. It is unclear to us which is exactly correct, but it does seem that 
both “madfitz” and “herr_als” behave exactly as they should in the case of 
character-independent diversification (i.e., reduces to likelihood of tree + likelihood of
trait model). We've also tested the behavior and the likelihood differences are very 
subtle and the parameter estimates in simulation are nearly indistinguishable from the
“madfitz” conditioning scheme. We provide both options and encourage users to try 
both and let us know conditions in which the result vary dramatically under the two root
implementations. We suspect they do not.</p>
<p>Also, note, that in the case of “root.type=user” and “root.type=equal” are
no longer explicit “root.type” options. Instead, either “madfitz” or 
“herr_als” are specified and the “root.p” can be set to allow for custom
root options.</p>
<p>Finally, the options “.beta” and “timeslice” are included, but neither have been tested -- needless to say, use at your own risk (but really, though, you should probably forget that these options exist for the time being). The “.beta” provides a means for testing for time-varying rates, whereas “timeslice” splits the tree to allow the process to vary before and after some user defined time period. These options will be further developed in due course.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>hisse.old</code> returns an object of class <code>hisse.fit</code>. This is a list with elements:</p>
<dl><dt>$loglik</dt>
<dd><p>the maximum negative log-likelihood.</p></dd>

<dt>$AIC</dt>
<dd><p>Akaike information criterion.</p></dd>

<dt>$AICc</dt>
<dd><p>Akaike information criterion corrected for sample-size.</p></dd>

<dt>$solution</dt>
<dd><p>a matrix containing the maximum likelihood estimates of the model parameters.</p></dd>

<dt>$index.par</dt>
<dd><p>an index matrix of the parameters being estimated.</p></dd>

<dt>$f</dt>
<dd><p>user-supplied sampling frequencies.</p></dd>

<dt>$hidden.states</dt>
<dd><p>a logical indicating whether a hidden state was included in the model.</p></dd>

<dt>$condition.on.surivival</dt>
<dd><p>a logical indicating whether the likelihood was conditioned on the survival of two lineages and the speciation event subtending them.</p></dd>

<dt>$root.type</dt>
<dd><p>indicates the user-specified root prior assumption.</p></dd>

<dt>$root.p</dt>
<dd><p>indicates whether the user-specified fixed root probabilities.</p></dd>

<dt>$timeslice</dt>
<dd><p>indicates whether the user-specified timeslice that split the tree.</p></dd>

<dt>$phy</dt>
<dd><p>user-supplied tree</p></dd>

<dt>$data</dt>
<dd><p>user-supplied dataset</p></dd>

<dt>$iterations</dt>
<dd><p>number of iterations of the likelihood search that were executed.</p></dd>

<dt>$output.type</dt>
<dd><p>the user-specified output.type to be printed on the screen.</p></dd>

<dt>$max.tol</dt>
<dd><p>relative optimization tolerance.</p></dd>

<dt>$upper.bounds</dt>
<dd><p>the vector of upper limits to the optimization search.</p></dd>

<dt>$lower.bounds</dt>
<dd><p>the vector of lower limits to the optimization search.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Beaulieu, J.M, and B.C. O'Meara. 2016. Detecting hidden diversification shifts in models of trait-dependent speciation and extinction. Syst. Biol. 65:583-601.</p>
<p>FitzJohn R.G., Maddison W.P., and Otto S.P. 2009. Estimating trait-dependent speciation and extinction rates from incompletely resolved phylogenies. Syst. Biol. 58:595-611.</p>
<p>Herrera-Alsina, L., P. van Els, and R.S. Etienne. 2018. Detecting the dependence of diversification on multiples traits from phylogenetic trees and trait data. Systematic Biology, 68:317-328.</p>
<p>Maddison W.P., Midford P.E., and Otto S.P. 2007. Estimating a binary characters effect on speciation and extinction. Syst. Biol. 56:701-710.</p>
<p>Nee S., May R.M., and Harvey P.H. 1994. The reconstructed evolutionary process. Philos. Trans. R. Soc. Lond. B Biol. Sci. 344:305-311.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jeremy M. Beaulieu</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeremy Beaulieu, Brian O’Meara, Daniel Caetano, James Boyko, Thais Vasconcelos.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

