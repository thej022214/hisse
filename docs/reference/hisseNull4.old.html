<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Original Four state trait-independent Hidden State Speciation and Extinction — hisse.null4.old • hisse</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Original Four state trait-independent Hidden State Speciation and Extinction — hisse.null4.old"><meta property="og:description" content="Sets up and executes the original four state trait-independent HiSSE model (Hidden State Speciation and Extinction) on a phylogeny and character set."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hisse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/adding_fossils.html">Incorporating Fossils in HiSSE, MuHiSSE, and MiSSE</a>
    </li>
    <li>
      <a href="../articles/Clade-specific-sampling.html">The Problem with Clade-specific Sampling Fractions</a>
    </li>
    <li>
      <a href="../articles/GeoHiSSE-vignette.html">Running GeoHiSSE</a>
    </li>
    <li>
      <a href="../articles/hisse-fisse-type1-vignette.html">Type I errors, Model rejection, &amp; HiSSE vs. FiSSE</a>
    </li>
    <li>
      <a href="../articles/hisse-new-vignette.html">A newer, faster HiSSE function</a>
    </li>
    <li>
      <a href="../articles/hisse-vignette.html">Running the old HiSSE function</a>
    </li>
    <li>
      <a href="../articles/MiSSE-vignette.html">Running MiSSE</a>
    </li>
    <li>
      <a href="../articles/MuHiSSE-vignette.html">Running a Multistate HiSSE model</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Original Four state trait-independent Hidden State Speciation and Extinction</h1>

    <div class="hidden name"><code>hisseNull4.old.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Sets up and executes the original four state trait-independent HiSSE model (Hidden State Speciation and Extinction) on a phylogeny and character set.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hisse.null4.old</span><span class="op">(</span><span class="va">phy</span>, <span class="va">data</span>, f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, turnover.anc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, </span>
<span>eps.anc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, trans.type<span class="op">=</span><span class="st">"equal"</span>, condition.on.survival<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>root.type<span class="op">=</span><span class="st">"madfitz"</span>, root.p<span class="op">=</span><span class="cn">NULL</span>,  output.type<span class="op">=</span><span class="st">"turnover"</span>, sann<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>sann.its<span class="op">=</span><span class="fl">1000</span>, bounded.search<span class="op">=</span><span class="cn">TRUE</span>, max.tol<span class="op">=</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">.50</span>,</span>
<span>starting.vals<span class="op">=</span><span class="cn">NULL</span>, turnover.upper<span class="op">=</span><span class="fl">10000</span>, eps.upper<span class="op">=</span><span class="fl">3</span>, trans.upper<span class="op">=</span><span class="fl">100</span>,</span>
<span>ode.eps<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>a phylogenetic tree, in <code>ape</code> “phylo” format and with internal nodes labeled denoting the ancestral selective regimes.</p></dd>

<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data matrix containing species information (see Details).</p></dd>

<dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>vector of length 2 with the estimated proportion of extant species in state 0 and 1 that are included in the phylogeny. A value of c(0.25, 0.5) means that 25 percent of species in state 0 and 50 percent of species in state 1 are included in the phylogeny. By default all species are assumed to be sampled.</p></dd>

<dt id="arg-turnover-anc">turnover.anc<a class="anchor" aria-label="anchor" href="#arg-turnover-anc"></a></dt>
<dd><p>a vector of length 8, indicating the free parameters associated with the net turnover rates. Default setting assumes character independent diversification (see Details).</p></dd>

<dt id="arg-eps-anc">eps.anc<a class="anchor" aria-label="anchor" href="#arg-eps-anc"></a></dt>
<dd><p>a vector of length 8, indicating the free parameters associated with the extinction fractions. Default setting assumes character independent diversification (see Details).</p></dd>

<dt id="arg-trans-type">trans.type<a class="anchor" aria-label="anchor" href="#arg-trans-type"></a></dt>
<dd><p>provides the type of transition rate model. Currently this model allows two types: “equal”, the default, which assumes all transitions are equal, and “three.rate”, that assumes three rates (see Details).</p></dd>

<dt id="arg-condition-on-survival">condition.on.survival<a class="anchor" aria-label="anchor" href="#arg-condition-on-survival"></a></dt>
<dd><p>a logical indicating whether the likelihood should be conditioned on the survival of two lineages and the speciation event subtending them (Nee et al. 1994). The default is <code>TRUE</code>.</p></dd>

<dt id="arg-root-type">root.type<a class="anchor" aria-label="anchor" href="#arg-root-type"></a></dt>
<dd><p>indicates whether root summarization follow the procedure described by FitzJohn et al. 2009, “madfitz” or Herrera-Alsina et al. 2018, “herr_als”.</p></dd>

<dt id="arg-root-p">root.p<a class="anchor" aria-label="anchor" href="#arg-root-p"></a></dt>
<dd><p>a vector indicating fixed root state probabilities. The default is <code>NULL</code>.</p></dd>

<dt id="arg-output-type">output.type<a class="anchor" aria-label="anchor" href="#arg-output-type"></a></dt>
<dd><p>indicates whether the rates should be printed onscreen as the optimized variables, “turnover”, transformed to reflect net diversification, “net.div”, or transformed to reflect \(\lambda\) and \(\mu\), “raw”.</p></dd>

<dt id="arg-sann">sann<a class="anchor" aria-label="anchor" href="#arg-sann"></a></dt>
<dd><p>a logical indicating whether a two-step optimization procedure is to be used. The first includes a simulate annealing approach, with the second involving a refinement using <code>subplex</code>. The default is <code>TRUE</code>.</p></dd>

<dt id="arg-sann-its">sann.its<a class="anchor" aria-label="anchor" href="#arg-sann-its"></a></dt>
<dd><p>a numeric indicating the number of times the simulated annealing algorithm should call the objective function.</p></dd>

<dt id="arg-bounded-search">bounded.search<a class="anchor" aria-label="anchor" href="#arg-bounded-search"></a></dt>
<dd><p>a logical indicating whether or not bounds should be enforced during optimization. The default is is <code>TRUE</code>.</p></dd>

<dt id="arg-max-tol">max.tol<a class="anchor" aria-label="anchor" href="#arg-max-tol"></a></dt>
<dd><p>supplies the relative optimization tolerance to <code>subplex</code>.</p></dd>

<dt id="arg-starting-vals">starting.vals<a class="anchor" aria-label="anchor" href="#arg-starting-vals"></a></dt>
<dd><p>a vector of starting values to be used instead of the default settings. These are just three values given in the following order: turnover (1), extinction fraction (2), and a single transition rate (3)</p></dd>

<dt id="arg-turnover-upper">turnover.upper<a class="anchor" aria-label="anchor" href="#arg-turnover-upper"></a></dt>
<dd><p>sets the upper bound for the turnover parameters. The default upper bound assumes an event occurs every 100 years.</p></dd>

<dt id="arg-eps-upper">eps.upper<a class="anchor" aria-label="anchor" href="#arg-eps-upper"></a></dt>
<dd><p>sets the upper bound for the extinction fraction parameters.</p></dd>

<dt id="arg-trans-upper">trans.upper<a class="anchor" aria-label="anchor" href="#arg-trans-upper"></a></dt>
<dd><p>sets the upper bound for the transition rate parameters.</p></dd>

<dt id="arg-ode-eps">ode.eps<a class="anchor" aria-label="anchor" href="#arg-ode-eps"></a></dt>
<dd><p>sets the tolerance for the integration at the end of a branch. Essentially if the sum of compD is less than this tolerance, then it assumes the results are unstable and discards them. The default is set to zero, but in testing a value of 1e-8 can sometimes produce stable solutions for both easy and very difficult optimization problems.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function sets up and executes a four-state trait independent HiSSE model. The model closely follows <code>hisse.old</code>. However, note that this function is no longer necessary and can be called and evaluated directly using the new <code>hisse</code> function.</p>
<p>Like <code>hisse.old</code>, users input vectors containing values to indicate how many free parameters are to be estimated for each of the variables in the model. However, the null-four model assumes that “turnover.anc” and “eps.anc” are linked between the two observed states. Thus, users are unlikely to alter the inputs much, aside from perhaps fixing “turnover.anc” or “eps.anc” to be equal across the four hidden states, where the “turnover.anc” input vector is set as rep(c(1,1,1,1),2). For a Yule equivalent, the input vector for “eps.anc” would be rep(c(0,0,0,0),2). For how to setup a null-two model see the example code below.</p>
<p>For user-specified “root.p”, you should specify the probability for each state. See help for “hisse.old” for more on other parameters for this function.</p>
<p>For the “root.type” option, we are currently maintaining the previous default of
“madfitz”. However, it was recently pointed out by Herrera-Alsina et al. (2018)
that at the root, the individual likelihoods for each possible state should be conditioned
prior to averaging the individual likelihoods across states. This can be set doing
“herr_als”. It is unclear to us which is exactly correct, but it does seem that
both “madfitz” and “herr_als” behave exactly as they should in the case of
character-independent diversification (i.e., reduces to likelihood of tree + likelihood of
trait model). We've also tested the behavior and the likelihood differences are very
subtle and the parameter estimates in simulation are nearly indistinguishable from the
“madfitz” conditioning scheme. We provide both options and encourage users to try
both and let us know conditions in which the result vary dramatically under the two root
implementations. We suspect they do not.</p>
<p>Also, note, that in the case of “root.type=user” and “root.type=equal” are
no longer explicit “root.type” options. Instead, either “madfitz” or
“herr_als” are specified and the “root.p” can be set to allow for custom
root options.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>hisse.null4.old</code> returns an object of class <code>hisse.fit</code>. This is a list with elements:</p>
<dl><dt>$loglik</dt>
<dd><p>the maximum negative log-likelihood.</p></dd>

<dt>$AIC</dt>
<dd><p>Akaike information criterion.</p></dd>

<dt>$AICc</dt>
<dd><p>Akaike information criterion corrected for sample-size.</p></dd>

<dt>$solution</dt>
<dd><p>a matrix containing the maximum likelihood estimates of the model parameters.</p></dd>

<dt>$index.par</dt>
<dd><p>an index matrix of the parameters being estimated.</p></dd>

<dt>$f</dt>
<dd><p>user-supplied sampling frequencies.</p></dd>

<dt>$condition.on.surivival</dt>
<dd><p>a logical indicating whether the likelihood was conditioned on the survival of two lineages and the speciation event subtending them.</p></dd>

<dt>$root.type</dt>
<dd><p>indicates the user-specified root prior assumption.</p></dd>

<dt>$root.p</dt>
<dd><p>indicates whether the user-specified fixed root probabilities.</p></dd>

<dt>$phy</dt>
<dd><p>user-supplied tree</p></dd>

<dt>$data</dt>
<dd><p>user-supplied dataset</p></dd>

<dt>$output.type</dt>
<dd><p>the user-specified output.type to be printed on the screen.</p></dd>

<dt>$trans.type</dt>
<dd><p>the user-specified transition model.</p></dd>

<dt>$trans.mat</dt>
<dd><p>the index matrix that specifies the free parameters in the transition model.</p></dd>

<dt>$max.tol</dt>
<dd><p>relative optimization tolerance.</p></dd>

<dt>$upper.bounds</dt>
<dd><p>the vector of upper limits to the optimization search.</p></dd>

<dt>$lower.bounds</dt>
<dd><p>the vector of lower limits to the optimization search.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Beaulieu, J.M, and B.C. O'Meara. 2016. Detecting hidden diversification shifts in models of trait-dependent speciation and extinction. Syst. Biol. 65:583-601.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jeremy M. Beaulieu</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeremy Beaulieu, Brian O’Meara, Daniel Caetano, James Boyko, Thais Vasconcelos.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

