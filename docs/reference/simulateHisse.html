<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate under a HiSSE model — SimulateHisse • hisse</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate under a HiSSE model — SimulateHisse"><meta property="og:description" content="Flexible simulation function allowing checkpointing"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hisse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/adding_fossils.html">Incorporating Fossils in HiSSE, MuHiSSE, and MiSSE</a>
    </li>
    <li>
      <a href="../articles/Clade-specific-sampling.html">The Problem with Clade-specific Sampling Fractions</a>
    </li>
    <li>
      <a href="../articles/GeoHiSSE-vignette.html">Running GeoHiSSE</a>
    </li>
    <li>
      <a href="../articles/hisse-fisse-type1-vignette.html">Type I errors, Model rejection, &amp; HiSSE vs. FiSSE</a>
    </li>
    <li>
      <a href="../articles/hisse-new-vignette.html">A newer, faster HiSSE function</a>
    </li>
    <li>
      <a href="../articles/hisse-vignette.html">Running the old HiSSE function</a>
    </li>
    <li>
      <a href="../articles/MiSSE-vignette.html">Running MiSSE</a>
    </li>
    <li>
      <a href="../articles/MuHiSSE-vignette.html">Running a Multistate HiSSE model</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate under a HiSSE model</h1>

    <div class="hidden name"><code>simulateHisse.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Flexible simulation function allowing checkpointing</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SimulateHisse</span><span class="op">(</span><span class="va">turnover.rates</span>, <span class="va">eps.values</span>, <span class="va">transition.rates</span>, max.taxa<span class="op">=</span><span class="cn">Inf</span>, max.t<span class="op">=</span><span class="cn">Inf</span>, </span>
<span>max.wall.time<span class="op">=</span><span class="cn">Inf</span>, <span class="va">x0</span>, nstart<span class="op">=</span><span class="fl">1</span>, checkpoint.file<span class="op">=</span><span class="cn">NULL</span>, checkpoint.frequency<span class="op">=</span><span class="fl">100</span>, </span>
<span>checkpoint.start.object<span class="op">=</span><span class="cn">NULL</span>, override.safeties<span class="op">=</span><span class="cn">FALSE</span>, mass.extinction.heights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>mass.extinction.magnitudes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-turnover-rates">turnover.rates<a class="anchor" aria-label="anchor" href="#arg-turnover-rates"></a></dt>
<dd><p>a vector of turnover rates.</p></dd>

<dt id="arg-eps-values">eps.values<a class="anchor" aria-label="anchor" href="#arg-eps-values"></a></dt>
<dd><p>a vector of extinction fractions.</p></dd>

<dt id="arg-transition-rates">transition.rates<a class="anchor" aria-label="anchor" href="#arg-transition-rates"></a></dt>
<dd><p>a matrix of transition rates.</p></dd>

<dt id="arg-max-taxa">max.taxa<a class="anchor" aria-label="anchor" href="#arg-max-taxa"></a></dt>
<dd><p>have the simulation stop at <code>max.taxa</code> surviving taxa.</p></dd>

<dt id="arg-max-t">max.t<a class="anchor" aria-label="anchor" href="#arg-max-t"></a></dt>
<dd><p>have the simulation stop at <code>max.t</code> height (including stem).</p></dd>

<dt id="arg-max-wall-time">max.wall.time<a class="anchor" aria-label="anchor" href="#arg-max-wall-time"></a></dt>
<dd><p>have the simulation stop at this many seconds of running.</p></dd>

<dt id="arg-x-">x0<a class="anchor" aria-label="anchor" href="#arg-x-"></a></dt>
<dd><p>the starting state.</p></dd>

<dt id="arg-nstart">nstart<a class="anchor" aria-label="anchor" href="#arg-nstart"></a></dt>
<dd><p>how many taxa you want to start from. Usual values are 1 (start with single lineage) or 2 (crown group).</p></dd>

<dt id="arg-checkpoint-file">checkpoint.file<a class="anchor" aria-label="anchor" href="#arg-checkpoint-file"></a></dt>
<dd><p>if you want to save progress (so you can restart from last saved point) include the name of a file.</p></dd>

<dt id="arg-checkpoint-frequency">checkpoint.frequency<a class="anchor" aria-label="anchor" href="#arg-checkpoint-frequency"></a></dt>
<dd><p>if there is a checkpoint file, frequency (in terms of number of steps: births, deaths, or transitions) at which this is saved.</p></dd>

<dt id="arg-checkpoint-start-object">checkpoint.start.object<a class="anchor" aria-label="anchor" href="#arg-checkpoint-start-object"></a></dt>
<dd><p>if you are starting from a checkpointed.file, the object loaded from that file. Typically called <code>checkpoint.result</code>.</p></dd>

<dt id="arg-override-safeties">override.safeties<a class="anchor" aria-label="anchor" href="#arg-override-safeties"></a></dt>
<dd><p>simulate even if there is no limit on number of taxa, depth of tree, or wall time.</p></dd>

<dt id="arg-mass-extinction-heights">mass.extinction.heights<a class="anchor" aria-label="anchor" href="#arg-mass-extinction-heights"></a></dt>
<dd><p>vector of times above the root [NOT from the present] to have a mass extinction.</p></dd>

<dt id="arg-mass-extinction-magnitudes">mass.extinction.magnitudes<a class="anchor" aria-label="anchor" href="#arg-mass-extinction-magnitudes"></a></dt>
<dd><p>vector of per species extinction probability at mass extinctions.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Note that currently, the simulator assumes <code>turnover.rates</code>, <code>eps.values</code>, and <code>transition rates</code> are in the same state order. Remember that <code>turnover.rates</code> are birth + death rates, and <code>eps.values</code> are death / birth rates.</p>
<p>We strongly advise putting some limits to stop the run. These can be any combination of <code>max.taxa</code>, <code>max.t</code>, and <code>max.wall.time</code>. For example, you could set up the run to stop when you hit 1000 taxa or 3600 seconds (one hour) of running on your computer, whichever comes first. If you want to run with no limits, you have to specify <code>override.safeties=TRUE</code>, and you should know what you're doing here (the runs might never finish). There is only one starting state (<code>x0</code>), which should be the index into the rate vectors, starting with 0: that is, if your states are 0A, 0B, 1A, and 1B, x0=0 would start in 0A, x0=3 would start in 1B. <code>nstart</code> lets you choose how many taxa to start with: it could be one lineage to start from a single taxon, in which case you'll have to wait some time for the first speciation event, or you could start with two, to start simulation with a clade of this size (though, if extinction is nonzero, you are not guaranteed to have the final crown group include both of these descendants). You can choose numbers higher than two, to start with, say, a 50-species polytomy. We're not sure why you would. You can add checkpointing: runs take a long time, and if it crashes, this will let you start from the same point in the last saved file (though with a different seed, unless you specify this yourself). If you want to save checkpoints as you go along, specify a file in <code>checkpoint.file</code>. Every <code>checkpoint.frequency</code> events, where an event is a speciation, extinction, or transition event, it will save current progress to a file. The smaller this value, the more frequently the simulation will be saved: fewer lost steps if you have to re-simulate, but slower during the run because it spends time writing to disk. If you want to start from a checkpointed analysis, load the file into R and then specify the object within R [not the file] containing the checkpointed results (by default, saved in an object called <code>checkpoint.result</code>) and the simulation will continue from that point.</p>
<p>Results are returned in a list, containing a dataframe with the outcome of the simulation (one row per edge in the tree, and containing information on the lengths, ancestor, tipward height from the original root, and state at the tipward end of the edge (you can get state at the rootward end by getting the tipward state of the ancestral edge). It may be of interest to know how many events of each type occurred, which is saved in <code>$birth.counts</code>, <code>$death.counts</code>, <code>$transition.counts</code>. The total number of surviving taxa is stored in <code>$n.surviving</code>.</p>
<p>The output can be returned as an ape <code>phylo</code> tree by passing the <code>$results</code> element of the final output to <code><a href="simToPhylo.html">SimToPhylo()</a></code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>This returns a list, with the following elements:</p>
<dl><dt>$results</dt>
<dd><p>a dataframe containing the simulation output: states at nodes and tips, ancestor-descendant pairs, branch lengths.</p></dd>

	<dt>$birth.counts</dt>
<dd><p>a vector, in the same state order as turnover.rates et al., that includes the counts for the number of times species in each state speciated.</p></dd>

	<dt>$death.counts</dt>
<dd><p>same as birth.counts, but counting extinction events in each state outside of mass extinctions.</p></dd>

	<dt>$mass.extinction.death.counts</dt>
<dd><p>total number of species that went extinct during a mass extinction event (which is assumed to be trait-independent).</p></dd>

	<dt>$transition.counts</dt>
<dd><p>matrix of counts of transitions from one state to another.</p></dd>

	<dt>$n.surviving</dt>
<dd><p>the number of taxa alive at the end of the simulation.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Beaulieu, J.M, and B.C. O'Meara. 2016. Detecting hidden diversification shifts in models of trait-dependent speciation and extinction. Syst. Biol. 65:583-601.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Brian O'Meara</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">simulated.result</span> <span class="op">&lt;-</span> <span class="fu">SimulateHisse</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">0</span><span class="op">)</span>, </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">0.2</span>, <span class="fl">.3</span>, <span class="cn">NA</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, max.taxa<span class="op">=</span><span class="fl">35</span>, x0<span class="op">=</span><span class="fl">1</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="simToPhylo.html">SimToPhylo</a></span><span class="op">(</span><span class="va">simulated.result</span><span class="op">$</span><span class="va">results</span>, include.extinct<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="simToPhylo.html">SimToPhylo</a></span><span class="op">(</span><span class="va">simulated.result</span><span class="op">$</span><span class="va">results</span>, include.extinct<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="simulateHisse-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }   </span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeremy Beaulieu, Brian O’Meara, Daniel Caetano, James Boyko, Thais Vasconcelos.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

